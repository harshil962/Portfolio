{% extends 'base.html' %}
{% load static %}

{% block title %}Portfolio | Harshil Prajapati{% endblock %}

{% block extra_css %}
<style>
    :root {
        --primary-gradient: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        --hover-gradient: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
        --card-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --card-hover-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    /* Hero Section - Modern Gradient */
    .hero-section {
        background: #0f172a; /* Fallback */
        background: radial-gradient(circle at top right, #1e293b, #0f172a);
        color: white;
        padding: 200px 0 100px; 
        text-align: center;
        margin-bottom: 80px;
        position: relative;
        overflow: hidden;
        min-height: 85vh; 
        display: flex;
        align-items: center;
    }

    /* Abstract background shape */
    .hero-section::before {
        content: '';
        position: absolute;
        top: -50%;
        left: -20%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(99, 102, 241, 0.15) 0%, rgba(0,0,0,0) 70%);
        pointer-events: none;
    }

    .hero-title {
        font-weight: 800;
        letter-spacing: -1px;
        margin-bottom: 1.5rem;
    }

    .highlight-text {
        background: var(--primary-gradient);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        font-weight: 800;
    }

    /* Buttons */
    .btn-gradient {
        background: var(--primary-gradient);
        border: none;
        color: white;
        padding: 12px 30px;
        font-weight: 600;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(99, 102, 241, 0.3);
    }
    .btn-gradient:hover {
        background: var(--hover-gradient);
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(99, 102, 241, 0.4);
        color: white;
    }

    .btn-outline-custom {
        border: 2px solid rgba(255,255,255,0.2);
        color: white;
        padding: 10px 28px;
        font-weight: 600;
        transition: all 0.3s ease;
    }
    .btn-outline-custom:hover {
        background: white;
        color: #0f172a;
        border-color: white;
    }

    /* Section Headings */
    .section-title {
        font-weight: 800;
        position: relative;
        display: inline-block;
        margin-bottom: 3rem;
        color: var(--text-color);
    }
    .section-title::after {
        content: '';
        position: absolute;
        bottom: -10px;
        left: 0;
        width: 60px;
        height: 4px;
        background: var(--primary-gradient);
        border-radius: 2px;
    }

    /* Project Cards */
    .project-card {
        border: none;
        border-radius: 16px;
        background: var(--card-bg, #fff);
        box-shadow: var(--card-shadow);
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        height: 100%;
        overflow: hidden;
    }
    
    [data-bs-theme="dark"] .project-card {
        background: #1e293b;
        border: 1px solid rgba(255,255,255,0.05);
    }

    .project-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--card-hover-shadow);
    }

    /* Card Image */
    .card-img-wrapper {
        height: 220px;
        position: relative;
        overflow: hidden;
    }
    .card-img-wrapper img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        transition: transform 0.5s ease;
    }
    .project-card:hover .card-img-wrapper img {
        transform: scale(1.08);
    }

    /* Video Badge */
    .video-badge {
        position: absolute;
        top: 15px;
        right: 15px;
        background: rgba(15, 23, 42, 0.8);
        color: white;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(4px);
        z-index: 10;
        border: 1px solid rgba(255,255,255,0.1);
        transition: transform 0.3s ease;
    }
    .project-card:hover .video-badge {
        transform: scale(1.1);
        background: var(--primary-gradient);
    }

    /* Tech Badges */
    .tech-stack-container {
        display: flex;
        flex-wrap: wrap;
        gap: 6px;
        margin-bottom: 15px;
    }
    .badge-soft {
        background: rgba(99, 102, 241, 0.1);
        color: #6366f1;
        font-weight: 600;
        padding: 6px 12px;
        border-radius: 20px;
        font-size: 0.75rem;
        letter-spacing: 0.5px;
    }
    [data-bs-theme="dark"] .badge-soft {
        background: rgba(99, 102, 241, 0.2);
        color: #a5b4fc;
    }

    /* Action Buttons in Card */
    .card-actions {
        margin-top: auto;
        padding-top: 15px;
        border-top: 1px solid rgba(0,0,0,0.05);
    }
    [data-bs-theme="dark"] .card-actions {
        border-top: 1px solid rgba(255,255,255,0.05);
    }
    
    .btn-card-action {
        padding: 8px 16px;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 500;
        transition: all 0.2s;
    }
    
    .btn-details {
        background: transparent;
        border: 1px solid #cbd5e1;
        color: var(--text-color);
    }
    [data-bs-theme="dark"] .btn-details {
        border-color: #475569;
        color: #e2e8f0;
    }
    .btn-details:hover {
        background: #f1f5f9;
        color: #0f172a;
    }
    [data-bs-theme="dark"] .btn-details:hover {
        background: #334155;
        color: white;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .hero-section { padding: 150px 0 60px; min-height: auto; }
        .hero-title { font-size: 2.5rem; }
        .btn-gradient, .btn-outline-custom { width: 100%; margin-bottom: 10px; }
    }
</style>
{% endblock %}

{% block content %}

<header class="hero-section">
    <div class="container position-relative" style="z-index: 2; width: 100%;">
        <h1 class="display-3 hero-title">I'm a <span class="auto-type highlight-text"></span></h1>
        <p class="lead mb-5 text-white-50 mx-auto" style="max-width: 600px;">
            Building scalable web applications with Django & React. Solving real-world problems with elegant code.
        </p>
        <div class="d-flex justify-content-center flex-wrap gap-3">
            <a href="#projects" class="btn btn-gradient rounded-pill">
                <i class="fas fa-layer-group me-2"></i>View My Work
            </a>
            <a href="/contact/" class="btn btn-outline-custom rounded-pill">
                <i class="fas fa-paper-plane me-2"></i>Contact Me
            </a>
        </div>
    </div>
</header>

<div class="container pb-5" id="projects">
    <div class="mb-5">
        <h2 class="section-title h2">Featured Projects</h2>
        <p class="text-muted">A selection of my recent work in web development.</p>
    </div>

    <div class="row g-4">
        {% for project in projects %}
        <div class="col-md-6 col-lg-4">
            <div class="card project-card">
                <div class="card-img-wrapper">
                    {% if project.demo_video %}
                        <div class="video-badge" data-bs-toggle="tooltip" title="Video Demo Available">
                            <i class="fas fa-play"></i>
                        </div>
                    {% endif %}

                    {% if project.image %}
                        <img src="{{ project.image.url }}" alt="{{ project.title }}">
                    {% else %}
                        <img src="https://via.placeholder.com/400x250/e2e8f0/64748b?text=Project+Preview" alt="Placeholder">
                    {% endif %}
                </div>

                <div class="card-body d-flex flex-column p-4">
                    <h5 class="card-title fw-bold mb-2">{{ project.title }}</h5>
                    
                    <div class="tech-stack-container">
                        {% for tech in project.get_tech_list|slice:":3" %}
                            <span class="badge-soft">{{ tech }}</span>
                        {% endfor %}
                        {% if project.get_tech_list|length > 3 %}
                            <span class="badge-soft">+{{ project.get_tech_list|length|add:"-3" }}</span>
                        {% endif %}
                    </div>

                    <p class="card-text text-muted small flex-grow-1 mb-4">
                        {{ project.description|truncatewords:18 }}
                    </p>

                    <div class="card-actions d-flex gap-2">
                        <button class="btn btn-details btn-card-action flex-grow-1" data-bs-toggle="modal" data-bs-target="#projectModal{{ forloop.counter }}">
                            <i class="fas fa-info-circle me-1"></i> Details
                        </button>
                        
                        {% if project.source_link %}
                            <a href="{{ project.source_link }}" target="_blank" class="btn btn-dark btn-card-action flex-grow-1 text-center">
                                <i class="fab fa-github me-1"></i> Source
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>

            <div class="modal fade" id="projectModal{{ forloop.counter }}" tabindex="-1" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered modal-lg">
                    <div class="modal-content border-0 shadow-lg rounded-4 overflow-hidden">
                        <div class="modal-header border-bottom-0 pb-0">
                            <h4 class="modal-title fw-bold ps-2">{{ project.title }}</h4>
                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                        </div>
                        
                        <div class="modal-body p-4">
                            <div class="rounded-3 overflow-hidden shadow-sm mb-4 bg-dark text-center">
                                {% if project.demo_video %}
                                    <video class="w-100" style="max-height: 450px; background: #000;" controls preload="none" poster="{{ project.image.url }}"> 
                                        <source src="{{ project.demo_video.url }}" type="video/mp4">
                                        Your browser does not support HTML5 video.
                                    </video>
                                {% elif project.image %}
                                    <img src="{{ project.image.url }}" class="img-fluid" style="max-height: 450px;">
                                {% endif %}
                            </div>

                            <div class="mb-4">
                                <h6 class="text-uppercase text-muted fw-bold small mb-2">Technologies Used</h6>
                                <div class="d-flex flex-wrap gap-2">
                                    {% for tech in project.get_tech_list %}
                                        <span class="badge bg-light text-dark border">{{ tech }}</span>
                                    {% endfor %}
                                </div>
                            </div>

                            <h6 class="text-uppercase text-muted fw-bold small mb-2">About</h6>
                            <div class="text-body opacity-75" style="line-height: 1.8;">
                                {{ project.description|linebreaks }}
                            </div>
                        </div>

                        <div class="modal-footer border-top-0 pt-0 pb-4 px-4 justify-content-center">
                            {% if project.source_link %}
                                <a href="{{ project.source_link }}" target="_blank" class="btn btn-gradient rounded-pill px-4">
                                    <i class="fab fa-github me-2"></i>Source Code
                                </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            </div>
        {% empty %}
        <div class="col-12 text-center py-5">
            <div class="py-5 bg-light rounded-3">
                <i class="fas fa-rocket fa-3x text-muted mb-3"></i>
                <h3 class="text-muted">Projects Landing Soon</h3>
                <p class="text-muted">I'm currently updating my portfolio. Check back shortly!</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="https://unpkg.com/typed.js@2.1.0/dist/typed.umd.js"></script>
<script>
    // Enable Bootstrap Tooltips
    var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
    var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
        return new bootstrap.Tooltip(tooltipTriggerEl)
    })

    var typed = new Typed(".auto-type", {
        strings: ["Full Stack Developer", "Django Enthusiast", "Tech Explorer", "Problem Solver"],
        typeSpeed: 80,
        backSpeed: 40,
        startDelay: 300,
        loop: true,
        showCursor: true,
        cursorChar: '|'
    });
</script>
{% endblock %}